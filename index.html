<!DOCTYPE html>
<html>
  <head>
    <title>Cryptographic Event Log v0.1</title>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <!--
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script src='https://www.w3.org/Tools/respec/respec-w3c' class='remove'></script>
    <script class="remove"
      src="https://cdn.jsdelivr.net/gh/digitalbazaar/respec-vc@3.3.5/dist/main.js"></script>

    <script class="remove">
      var respecConfig = {
        group: "credentials",

        // specification status (for example, WD, LCWD, NOTE, etc.). If in doubt use ED.
        specStatus: "CG-DRAFT",

        // the specification's short name, as in http://www.w3.org/TR/short-name/
        shortName: "cel-1.0",

        // subtitle for the spec
        subtitle: "A cryptographic protocol for verifying a log of changes to data",

        // if you wish the publication date to be other than today, set this
        //publishDate: "2024-11-05",
        //crEnd: "2024-12-05",
        //prEnd: "2019-10-01",
        //implementationReportURI: "https://w3c.github.io/vc-data-model-2.0-test-suite/",
        //errata: "https://w3c.github.io/vc-data-model/errata.html",
        //previousMaturity: "REC",
        //previousPublishDate: "2022-03-03",

        // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
        // and its maturity status
        // previousPublishDate:  "1977-03-15",
        // previousMaturity:  "WD",

        // extend the bibliography entries
        localBiblio: {},
        doJsonLd: true,

        // Uncomment these to use the respec extension that generates a list of
        //   normative statements:
        preProcess: [/*prepare_reqlist*/],
        postProcess: [
          /*add_reqlist_button*/
        ],

        github: "https://github.com/digitalbazaar/cel-spec/",
        includePermalinks: false,

        // if there a publicly available Editor's Draft, this is the link
        edDraftURI: "https://digitalbazaar.github.io/cel-spec/",

        // if this is a LCWD, uncomment and set the end of its review period
        // lcEnd: "2009-08-05",

        // editors, add as many as you like
        // only "name" is required
        editors: [
          { name: "Manu Sporny", url: "https://www.linkedin.com/in/manusporny/",
            company: "Digital Bazaar", companyURL: "https://digitalbazaar.com/",
            w3cid: 41758}
        ],
        formerEditors: [
        ],
        // authors, add as many as you like.
        // This is optional, uncomment if you have authors as well as editors.
        // only "name" is required. Same format as editors.
        authors:
        [
          { name: "Manu Sporny", url: "https://digitalbazaar.com/",
            company: "Digital Bazaar", companyURL: "https://digitalbazaar.com/",
            w3cid: 41758
          },
          { name: "Dave Longley", url: "https://digitalbazaar.com/",
            company: "Digital Bazaar", companyURL: "https://digitalbazaar.com/",
            w3cid: 48025
          },
          { name: "Christine Lemmer-Webber",
            url: "https://dustycloud.org/",
            company: "Spritely Institute",
            companyURL: "https://spritely.institute/",
            w3cid: 0
          }
        ],
        xref: ["URL", "I18N-GLOSSARY", "INFRA", "VC-DATA-INTEGRITY"],
        lint: { "informative-dfn": false },
        maxTocLevel: 3,
        inlineCSS: true
      };
    </script>
    <style>
code {
  color: rgb(199, 73, 0);
  font-weight: bold;
}
pre {
  overflow-x: auto;
  white-space: pre-wrap;
}
pre .highlight {
  font-weight: bold;
  color: Green;
}
pre .subject {
  font-weight: bold;
  color: RoyalBlue;
}
pre .property {
  font-weight: bold;
  color: DarkGoldenrod;
}
pre .comment {
  font-weight: bold;
  color: SteelBlue;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
ol.algorithm {
  counter-reset: numsection;
  list-style-type: none;
}
ol.algorithm li {
  margin: 0.5em 0;
}
ol.algorithm li:before {
  font-weight: bold;
  counter-increment: numsection;
  content: counters(numsection, ".") ") ";
}

table.simple {
    border-collapse: collapse;
    margin: 25px 0;
    min-width: 400px;
    border: 1px solid #dddddd;
}
table.simple thead tr {
    background-color: #005a9c;
    color: #ffffff;
    text-align: left;
}
table.simple th,
table.simple td {
    padding: 12px 15px;
    vertical-align: top;
    text-align: left;
}
table.simple tbody tr {
    border-bottom: 1px solid #dddddd;
}
table.simple tbody tr:nth-of-type(even) {
    background-color: #00000008;
}
table.simple tbody tr:last-of-type {
    border-bottom: 2px solid #005a9c;
}
    </style>
  </head>
  <body>
    <section id='abstract'>
      <p>
This specification defines a data model for an author to express changes to data
over time and the means for a verifier to cryptographically verify those
changes.
      </p>
    </section>

    <section id='sotd'>
      <p>
An experimental thought exercise, for now. Potentially, a data structure for
cryptographic event logging of data objects such as DID Documents, ActivityPub
objects, and other data formats.
      </p>
    </section>

    <section class="informative">
      <h2>Introduction</h2>


      <section id="conformance">
        <p>
A <dfn>conforming log</dfn> is any [=byte sequence=] that can be
converted to a
<a data-cite="INFRA#parse-json-bytes-to-a-javascript-value">
JSON document</a> that follows the relevant normative requirements in
Sections [[[#data-model]]].
        </p>

        <p>
A <dfn class="lint-ignore">conforming event log specification</dfn> is
any specification that follows the relevant normative requirements in Section
[[[#event-log-specifications]]].
        </p>

        <p>
A <dfn class="lint-ignore">conforming processor</dfn> is any algorithm realized
as software and/or hardware that generates and/or consumes a
[=conforming log=] according to the relevant normative statements
in Section [[[#algorithms]]]. Conforming processors MUST produce errors when
non-conforming documents are consumed.
        </p>
      </section>

    </section>

    <section class="normative">
      <h2>Data Model</h2>

      <p>

      </p>

      <section class="normative">
        <h2>Cryptographic Event Log Entry</h2>

        <p>
A cryptographic event log entry is used to establish an event that can be
independently verified by a verifier. The log entry MUST be composed of
at least a single `event` and one or more associated `proof` values that can be
used to verify the validity of the event.
        </p>

        <p>
A [=conforming processor=] MUST support `proof` values expressed using the
[[[VC-DI-ECDSA]]] specification and the `ecdsa-jcs-2019` cryptosuite and
MAY support other proof formats.
        </p>

        <pre class="example nohighlight" title="An event log entry containing data embedded directly in the event.">
{
  "event": {
    <span class="comment">// the type of event</span>
    "type": "Create",
    <span class="comment">// the data associated with the event (in JSON format)</span>
    "data": {
      "name": "Hello World!",
      <span class="comment">// the cryptographic authority for the data is established in this object</span>
      <span class="comment">// for example: "authority": "https://website.example/crypto#key-1"</span>
    }
  },
  <span class="comment">// one or more proofs that secure the integrity of the event above</span>
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "ecdsa-jcs-2019",
    "created": "2024-11-29T13:56:28Z",
    "verificationMethod": "https://website.example/crypto#key-1",
    "proofPurpose": "assertionMethod",
    "proofValue": "zq6PrUMCtqY5obCSsrQxuFJd...wVWgHYrXxoV93gBHqGDBtQLPFxpZxz"
  }
}
        </pre>

        <p>
Some data are too large to include in the event log itself. For these cases,
it is possible to refer to data outside of the event log and digitally sign
a cryptographic hash of the external data. It is also possible to provide
multiple URLs for a verifier to use when retrieving the external data.
        </p>

        <pre class="example nohighlight" title="An event log entry containing a reference to data.">
{
  "event": {
    "type": "Create",
    <span class="comment">// a reference to the data associated with the event</span>
    "dataReference": {
      <span class="comment">// URLs that can be used to retrieve the data</span>
      "url": [
        "https://website.example/file.dat",
        "3jxop4cs2lu5ur2...sseqdsp3k262uwy4.onion/file.dat",
        "ipfs://QmTy8w65yBXgyfG2ZBg5TrfB2hPjrDQH3RCQFJGkARStJb"
      ],
      <span class="comment">// The media type of the associated data</span>
      "mediaType": "application/octet-stream",
      <span class="comment">// a cryptographic digest of the data (sha2-256 base64-url-nopad)</span>
      "digestMultibase": "uEiAkoYyQ6YVtUmER8pN24wLZcLK9EBguM5WZlbAgfXBDuQ"
    }
  },
  <span class="comment">// one or more proofs that secure the integrity of the event above</span>
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "ecdsa-jcs-2019",
    "created": "2024-11-29T13:56:28Z",
    "verificationMethod": "https://website.example/crypto#key-1",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5obCSsrQxuFJdq6PrUMCtqY...93gBHqGDBtQLPFxpZxzwVWgHYrXxoV"
  }
}
        </pre>


      </section>

      <section class="normative">
        <h2>Event Witness</h2>

        <p>
An <dfn>event witness</dfn> is a service that can attest to the existence of
data at a particular point in time. These services are trusted by the verifier
to attest to the existence of data at a particular point in time by digitally
signing a cryptographic hash that is provided to them such that they do not
see the data, but confirm the existence of the data.
        </p>

        <p>
The [=event witness=] performs their function by appending another
[=data integrity proof=] onto the array of `proof` values.
        </p>

        <pre class="example nohighlight" title="An event log entry containing a reference to data.">
{
  "event": {
    "type": "Create",
    <span class="comment">// a reference to the data associated with the event</span>
    "dataReference": {
      <span class="comment">// URLs that can be used to retrieve the data</span>
      "url": [
        "https://website.example/file.dat",
        "3jxop4cs2lu5ur2...sseqdsp3k262uwy4.onion/file.dat",
        "ipfs://QmTy8w65yBXgyfG2ZBg5TrfB2hPjrDQH3RCQFJGkARStJb"
      ],
      <span class="comment">// The media type of the associated data</span>
      "mediaType": "application/octet-stream",
      <span class="comment">// a cryptographic digest of the data (sha2-256 base64-url-nopad)</span>
      "digestMultibase": "uEiAkoYyQ6YVtUmER8pN24wLZcLK9EBguM5WZlbAgfXBDuQ"
    }
  },
  <span class="comment">// one or more proofs that secure the integrity of the event above</span>
  "proof": [{
    "type": "DataIntegrityProof",
    "cryptosuite": "ecdsa-jcs-2019",
    "created": "2024-11-29T13:56:28Z",
    "verificationMethod": "https://website.example/crypto#key-1",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5obCSsrQxuFJdq6PrUMCtqY...93gBHqGDBtQLPFxpZxzwVWgHYrXxoV"
  }, {
    "type": "DataIntegrityProof",
    "cryptosuite": "ecdsa-jcs-2019",
    "created": "2024-11-29T13:56:45Z",
    "verificationMethod": "https://witness.example/attestation#key-P8",
    "proofPurpose": "assertionMethod",
    "proofValue": "zJdq6PrUMCtqY5obCSsrQxuF...tQLPFxpZxzwVWgHYrXxoV93gBHqGDB"
  }]
}
        </pre>

      </section>

    </section>

    <section class="normative">
      <h2>Algorithms</h2>

      <p>

      </p>

    </section>

    <section class="normative">
      <h2>Event Log Specifications</h2>

      <p>

      </p>

    </section>

  </body>
</html>
